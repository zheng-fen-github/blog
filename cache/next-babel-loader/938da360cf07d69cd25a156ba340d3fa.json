{"ast":null,"code":"var _jsxFileName = \"C:\\\\newlife\\\\newSite\\\\my-app\\\\component\\\\home\\\\photo.js\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React, { useEffect, useState } from \"react\";\n\nconst Photo = ({\n  id,\n  name,\n  classname\n}) => {\n  const {\n    0: bolb,\n    1: setBolb\n  } = useState(null);\n  const {\n    0: error,\n    1: setError\n  } = useState(false);\n\n  const getphoto = async () => {\n    try {\n      const QURL = process.env.DATA_URL + \"addphoto/getphoto/\" + id;\n      let get = await fetch(QURL);\n\n      if (get.ok) {\n        let blob = await get.blob();\n        let img = document.createElement(\"img\");\n        img.src = URL.createObjectURL(blob);\n\n        img.onload = () => {\n          document.querySelector(\".photo-container\").append(img);\n          canvasFunc(img.offsetWidth, img.offsetHeight, img, setBolb);\n        };\n      }\n    } catch (err) {\n      console.log(err);\n      setError(true);\n    }\n  };\n\n  useEffect(() => {\n    getphoto();\n  }, [id]);\n  return __jsx(React.Fragment, null, bolb && __jsx(\"img\", {\n    src: URL.createObjectURL(bolb),\n    alt: name,\n    className: \"jsx-2887014874\" + \" \" + \"w-100\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 30,\n      columnNumber: 9\n    }\n  }), !bolb || !error && __jsx(\"div\", {\n    className: \"jsx-2887014874\" + \" \" + (\"loading \" + classname || \"\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 32,\n      columnNumber: 28\n    }\n  }), error && __jsx(\"h2\", {\n    className: \"jsx-2887014874\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 33,\n      columnNumber: 17\n    }\n  }, \" \\u52A0\\u8F7D\\u56FE\\u7247\\u5931\\u8D25 \"), __jsx(\"div\", {\n    style: {\n      position: \"fixed\",\n      left: 0,\n      top: 0,\n      visibility: \"hidden\",\n      userSelect: \"none\"\n    },\n    className: \"jsx-2887014874\" + \" \" + \"photo-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 34,\n      columnNumber: 7\n    }\n  }), __jsx(\"canvas\", {\n    id: \"canvas\",\n    hidden: true,\n    className: \"jsx-2887014874\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 7\n    }\n  }), __jsx(_JSXStyle, {\n    id: \"2887014874\",\n    __self: this\n  }, \".loading.jsx-2887014874{width:100%;height:20px;background:black;height:20vh;-webkit-animation:show-jsx-2887014874 2s infinite;animation:show-jsx-2887014874 2s infinite;z-index:99;}.right.jsx-2887014874{height:44vh;}@-webkit-keyframes show-jsx-2887014874{0%{background:black;}50%{background:#cbcbcb;}100%{background:black;}}@keyframes show-jsx-2887014874{0%{background:black;}50%{background:#cbcbcb;}100%{background:black;}}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxuZXdsaWZlXFxuZXdTaXRlXFxteS1hcHBcXGNvbXBvbmVudFxcaG9tZVxccGhvdG8uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBOENTLEFBR3dCLEFBUUMsQUFJTyxBQUdFLEFBR0YsV0FqQlAsQ0FRZCxLQUlFLEFBTUEsRUFIQSxJQWRpQixpQkFDTCxZQUNlLDRGQUNoQixXQUNiIiwiZmlsZSI6IkM6XFxuZXdsaWZlXFxuZXdTaXRlXFxteS1hcHBcXGNvbXBvbmVudFxcaG9tZVxccGhvdG8uanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgdXNlRWZmZWN0LCB1c2VTdGF0ZSB9IGZyb20gXCJyZWFjdFwiO1xyXG5cclxuY29uc3QgUGhvdG8gPSAoeyBpZCwgbmFtZSwgY2xhc3NuYW1lIH0pID0+IHtcclxuICBjb25zdCBbYm9sYiwgc2V0Qm9sYl0gPSB1c2VTdGF0ZShudWxsKTtcclxuICBjb25zdCBbZXJyb3IsIHNldEVycm9yXSA9IHVzZVN0YXRlKGZhbHNlKTtcclxuICBjb25zdCBnZXRwaG90byA9IGFzeW5jICgpID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IFFVUkwgPSBwcm9jZXNzLmVudi5EQVRBX1VSTCArIFwiYWRkcGhvdG8vZ2V0cGhvdG8vXCIgKyBpZDtcclxuICAgICAgbGV0IGdldCA9IGF3YWl0IGZldGNoKFFVUkwpO1xyXG4gICAgICBpZiAoZ2V0Lm9rKSB7XHJcbiAgICAgICAgbGV0IGJsb2IgPSBhd2FpdCBnZXQuYmxvYigpO1xyXG4gICAgICAgIGxldCBpbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW1nXCIpO1xyXG4gICAgICAgIGltZy5zcmMgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpO1xyXG4gICAgICAgIGltZy5vbmxvYWQgPSAoKSA9PiB7XHJcbiAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBob3RvLWNvbnRhaW5lclwiKS5hcHBlbmQoaW1nKTtcclxuICAgICAgICAgIGNhbnZhc0Z1bmMoaW1nLm9mZnNldFdpZHRoLCBpbWcub2Zmc2V0SGVpZ2h0LCBpbWcsIHNldEJvbGIpO1xyXG4gICAgICAgIH07XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICBzZXRFcnJvcih0cnVlKTtcclxuICAgIH1cclxuICB9O1xyXG4gIHVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICBnZXRwaG90bygpO1xyXG4gIH0sIFtpZF0pO1xyXG4gIHJldHVybiAoXHJcbiAgICA8PlxyXG4gICAgICB7Ym9sYiAmJiAoXHJcbiAgICAgICAgPGltZyBzcmM9e1VSTC5jcmVhdGVPYmplY3RVUkwoYm9sYil9IGFsdD17bmFtZX0gY2xhc3NOYW1lPVwidy0xMDBcIiAvPlxyXG4gICAgICApfVxyXG4gICAgICB7IWJvbGIgfHwgKCFlcnJvciAmJiA8ZGl2IGNsYXNzTmFtZT17XCJsb2FkaW5nIFwiICsgY2xhc3NuYW1lfT48L2Rpdj4pfVxyXG4gICAgICB7ZXJyb3IgJiYgPGgyPiDliqDovb3lm77niYflpLHotKUgPC9oMj59XHJcbiAgICAgIDxkaXZcclxuICAgICAgICBjbGFzc05hbWU9XCJwaG90by1jb250YWluZXJcIlxyXG4gICAgICAgIHN0eWxlPXt7XHJcbiAgICAgICAgICBwb3NpdGlvbjogXCJmaXhlZFwiLFxyXG4gICAgICAgICAgbGVmdDogMCxcclxuICAgICAgICAgIHRvcDogMCxcclxuICAgICAgICAgIHZpc2liaWxpdHk6IFwiaGlkZGVuXCIsXHJcbiAgICAgICAgICB1c2VyU2VsZWN0OiBcIm5vbmVcIixcclxuICAgICAgICB9fVxyXG4gICAgICA+PC9kaXY+XHJcbiAgICAgIDxjYW52YXMgaWQ9XCJjYW52YXNcIiBoaWRkZW4+PC9jYW52YXM+XHJcblxyXG4gICAgICA8c3R5bGUganN4PlxyXG4gICAgICAgIHtgXHJcbiAgICAgICAgICAubG9hZGluZyB7XHJcbiAgICAgICAgICAgIHdpZHRoOiAxMDAlO1xyXG4gICAgICAgICAgICBoZWlnaHQ6IDIwcHg7XHJcbiAgICAgICAgICAgIGJhY2tncm91bmQ6IGJsYWNrO1xyXG4gICAgICAgICAgICBoZWlnaHQ6IDIwdmg7XHJcbiAgICAgICAgICAgIGFuaW1hdGlvbjogc2hvdyAycyBpbmZpbml0ZTtcclxuICAgICAgICAgICAgei1pbmRleDogOTk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICAucmlnaHQge1xyXG4gICAgICAgICAgICBoZWlnaHQ6IDQ0dmg7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBAa2V5ZnJhbWVzIHNob3cge1xyXG4gICAgICAgICAgICAwJSB7XHJcbiAgICAgICAgICAgICAgYmFja2dyb3VuZDogYmxhY2s7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgNTAlIHtcclxuICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiAjY2JjYmNiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIDEwMCUge1xyXG4gICAgICAgICAgICAgIGJhY2tncm91bmQ6IGJsYWNrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgYH1cclxuICAgICAgPC9zdHlsZT5cclxuICAgIDwvPlxyXG4gICk7XHJcbn07XHJcblxyXG5jb25zdCBjYW52YXNGdW5jID0gKFcsIEgsIGltZywgbG9hZFBob3RvKSA9PiB7XHJcbiAgbGV0IGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2FudmFzXCIpO1xyXG4gIGxldCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xyXG4gIGxldCBjb3VudCA9IE1hdGgubWluKFcsIEgpO1xyXG4gIGNhbnZhcy53aWR0aCA9IGNvdW50O1xyXG4gIGNhbnZhcy5oZWlnaHQgPSBjb3VudDtcclxuICBsZXQgdyA9IChNYXRoLm1heChXLCBIKSAtIGNvdW50KSAvIDI7XHJcbiAgVyA+IEggPyBjdHguZHJhd0ltYWdlKGltZywgLXcsIDApIDogY3R4LmRyYXdJbWFnZShpbWcsIDAsIC13KTsgLy/oo4Hlh4/miJDkuIDmr5TkuIBcclxuICBjYW52YXMudG9CbG9iKChibG9iKSA9PiB7XHJcbiAgICAvLyDovpPlh7rlm77niYdcclxuICAgIGxvYWRQaG90byhibG9iKTtcclxuICB9LCBcImltYWdlL3BuZ1wiKTtcclxufTtcclxuZXhwb3J0IGRlZmF1bHQgUGhvdG87XHJcbiJdfQ== */\\n/*@ sourceURL=C:\\\\\\\\newlife\\\\\\\\newSite\\\\\\\\my-app\\\\\\\\component\\\\\\\\home\\\\\\\\photo.js */\"));\n};\n\nconst canvasFunc = (W, H, img, loadPhoto) => {\n  let canvas = document.getElementById(\"canvas\");\n  let ctx = canvas.getContext(\"2d\");\n  let count = Math.min(W, H);\n  canvas.width = count;\n  canvas.height = count;\n  let w = (Math.max(W, H) - count) / 2;\n  W > H ? ctx.drawImage(img, -w, 0) : ctx.drawImage(img, 0, -w); //裁减成一比一\n\n  canvas.toBlob(blob => {\n    // 输出图片\n    loadPhoto(blob);\n  }, \"image/png\");\n};\n\nexport default Photo;","map":{"version":3,"sources":["C:/newlife/newSite/my-app/component/home/photo.js"],"names":["React","useEffect","useState","Photo","id","name","classname","bolb","setBolb","error","setError","getphoto","QURL","process","env","DATA_URL","get","fetch","ok","blob","img","document","createElement","src","URL","createObjectURL","onload","querySelector","append","canvasFunc","offsetWidth","offsetHeight","err","console","log","position","left","top","visibility","userSelect","W","H","loadPhoto","canvas","getElementById","ctx","getContext","count","Math","min","width","height","w","max","drawImage","toBlob"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\n\r\nconst Photo = ({ id, name, classname }) => {\r\n  const [bolb, setBolb] = useState(null);\r\n  const [error, setError] = useState(false);\r\n  const getphoto = async () => {\r\n    try {\r\n      const QURL = process.env.DATA_URL + \"addphoto/getphoto/\" + id;\r\n      let get = await fetch(QURL);\r\n      if (get.ok) {\r\n        let blob = await get.blob();\r\n        let img = document.createElement(\"img\");\r\n        img.src = URL.createObjectURL(blob);\r\n        img.onload = () => {\r\n          document.querySelector(\".photo-container\").append(img);\r\n          canvasFunc(img.offsetWidth, img.offsetHeight, img, setBolb);\r\n        };\r\n      }\r\n    } catch (err) {\r\n      console.log(err);\r\n      setError(true);\r\n    }\r\n  };\r\n  useEffect(() => {\r\n    getphoto();\r\n  }, [id]);\r\n  return (\r\n    <>\r\n      {bolb && (\r\n        <img src={URL.createObjectURL(bolb)} alt={name} className=\"w-100\" />\r\n      )}\r\n      {!bolb || (!error && <div className={\"loading \" + classname}></div>)}\r\n      {error && <h2> 加载图片失败 </h2>}\r\n      <div\r\n        className=\"photo-container\"\r\n        style={{\r\n          position: \"fixed\",\r\n          left: 0,\r\n          top: 0,\r\n          visibility: \"hidden\",\r\n          userSelect: \"none\",\r\n        }}\r\n      ></div>\r\n      <canvas id=\"canvas\" hidden></canvas>\r\n\r\n      <style jsx>\r\n        {`\r\n          .loading {\r\n            width: 100%;\r\n            height: 20px;\r\n            background: black;\r\n            height: 20vh;\r\n            animation: show 2s infinite;\r\n            z-index: 99;\r\n          }\r\n          .right {\r\n            height: 44vh;\r\n          }\r\n          @keyframes show {\r\n            0% {\r\n              background: black;\r\n            }\r\n            50% {\r\n              background: #cbcbcb;\r\n            }\r\n            100% {\r\n              background: black;\r\n            }\r\n          }\r\n        `}\r\n      </style>\r\n    </>\r\n  );\r\n};\r\n\r\nconst canvasFunc = (W, H, img, loadPhoto) => {\r\n  let canvas = document.getElementById(\"canvas\");\r\n  let ctx = canvas.getContext(\"2d\");\r\n  let count = Math.min(W, H);\r\n  canvas.width = count;\r\n  canvas.height = count;\r\n  let w = (Math.max(W, H) - count) / 2;\r\n  W > H ? ctx.drawImage(img, -w, 0) : ctx.drawImage(img, 0, -w); //裁减成一比一\r\n  canvas.toBlob((blob) => {\r\n    // 输出图片\r\n    loadPhoto(blob);\r\n  }, \"image/png\");\r\n};\r\nexport default Photo;\r\n"]},"metadata":{},"sourceType":"module"}