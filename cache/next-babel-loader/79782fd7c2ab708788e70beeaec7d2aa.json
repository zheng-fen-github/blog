{"ast":null,"code":"import _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React, { useEffect, useState } from 'react';\n\nconst Comment = ({\n  message,\n  id\n}) => {\n  useEffect(() => {\n    //获取用户信息\n    let userId = localStorage.getItem('user-id');\n    let userName = localStorage.getItem('user-name');\n\n    if (!userId) {\n      console.log('one');\n      userId = 'youke' + Date.now();\n      localStorage.setItem('user-id', userId);\n    }\n\n    if (!userName) {\n      console.log('one');\n      userName = '游客' + String(Date.now()).slice(-5);\n      localStorage.setItem('user-name', userName);\n    }\n\n    setUserName(userName);\n  }, []);\n  const {\n    0: userName,\n    1: setUserName\n  } = useState(null);\n\n  const changeUserName = e => {\n    //用户自定义名字\n    let value = e.target.value;\n    setUserName(value);\n    localStorage.setItem('user-name', userName);\n  };\n\n  const submitEvent = async e => {\n    //提交事件                \n    try {\n      e.preventDefault();\n      let data = new FormData(e.target);\n      const QURL = process.env.DATA_URL + 'addArticle/articleComment/' + id;\n      let res = await fetch(QURL, {\n        method: 'POST',\n        body: data\n      });\n\n      if (res.ok) {\n        let result = await res.json();\n        setState(result);\n      } else {\n        alert('添加出错，服务器去看妹子了。');\n        console.log(error);\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  const inputAutoHeight = e => {\n    let dom = e.target; // 内容高度自动适应                    \n\n    dom.style.height = dom.scrollHeight > dom.offsetHeight ? dom.scrollHeight + 10 + 'px' : dom.offsetHeight + 'px';\n  };\n\n  const {\n    0: state,\n    1: setState\n  } = useState(message.slice(0, 3)); //评论列表\n\n  let domList = state.map(item => __jsx(\"div\", {\n    className: \"col-12\",\n    key: item.createTime\n  }, __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"h3\", null, item.username + ' : ' + item.message))));\n  return __jsx(\"form\", {\n    onSubmit: submitEvent,\n    className: \"jsx-2920962868\" + \" \" + 'row comment m-0 p-0 justify-content-center'\n  }, __jsx(\"div\", {\n    className: \"jsx-2920962868\" + \" \" + \"col-10 col-lg-8 \"\n  }, __jsx(\"div\", {\n    className: \"jsx-2920962868\" + \" \" + \"row justify-content-between \"\n  }, __jsx(\"h2\", {\n    className: \"jsx-2920962868\" + \" \" + 'comment-item m-0 py-3'\n  }, message.length, \" Comments\"), __jsx(\"input\", {\n    type: \"text\",\n    name: \"username\",\n    value: userName ? userName : '',\n    onInput: changeUserName,\n    onChange: changeUserName,\n    id: \"username\",\n    className: \"jsx-2920962868\" + \" \" + \"px-4 usename text-center\"\n  })), __jsx(\"div\", {\n    className: \"jsx-2920962868\" + \" \" + \"row mt-5 align-items-center\"\n  }, __jsx(\"img\", {\n    src: \"images/site_05.jpg\",\n    alt: \"\",\n    className: \"jsx-2920962868\" + \" \" + 'col-auto'\n  }), __jsx(\"textarea\", {\n    type: \"text\",\n    name: \"message\",\n    id: \"comment\",\n    onInput: inputAutoHeight,\n    className: \"jsx-2920962868\" + \" \" + 'col px-4 py-2'\n  }), __jsx(\"button\", {\n    type: \"submit\",\n    className: \"jsx-2920962868\"\n  }, __jsx(\"i\", {\n    className: \"jsx-2920962868\" + \" \" + 'iconfont icon-cloud-upload col-auto'\n  }))), __jsx(\"div\", {\n    style: {\n      padding: '20px 80px'\n    },\n    className: \"jsx-2920962868\" + \" \" + \"row comment-list justify-content-center align-items-center position-relative\"\n  }, message.length > 0 ? domList : __jsx(\"h3\", {\n    className: \"jsx-2920962868\"\n  }, \" Be the first to comment\\u3002 \"), __jsx(\"h4\", {\n    onClick: () => setState(message),\n    className: \"jsx-2920962868\" + \" \" + 'position-absolute look-more'\n  }, \"look more\"))), __jsx(_JSXStyle, {\n    id: \"2920962868\"\n  }, [\".comment.jsx-2920962868{padding:10rem 0;}\", \"h2.jsx-2920962868{font-weight:700;}\", \".look-more.jsx-2920962868{right:70px;top:10px;color:#007bff;cursor:pointer;}\", \"i.jsx-2920962868{font-size:40px;cursor:pointer;-webkit-transition:.2s;transition:.2s;}\", \"i.jsx-2920962868:hover{color:#007bff;}\", \".col-8.jsx-2920962868>.row.jsx-2920962868:nth-child(1){border-bottom:2px solid #eaeaea;}\", \"img.jsx-2920962868{height:40px;border-radius:50%;}\", \".comment-item.jsx-2920962868{border-bottom:2px solid black;position:relative;top:2px;}\", \".comment-list.jsx-2920962868{min-height:20vh;border-bottom:2px solid #eaeaea;}\", \"input.jsx-2920962868,textarea.jsx-2920962868{font-size:2rem;font-weight:500;}\", \"input[name='username'].jsx-2920962868{border:none;}\", \"button.jsx-2920962868{background:none;border:none;}\"]));\n};\n\nexport default Comment;","map":null,"metadata":{},"sourceType":"module"}