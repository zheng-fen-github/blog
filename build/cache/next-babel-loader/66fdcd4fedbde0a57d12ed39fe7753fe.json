{"ast":null,"code":"var _jsxFileName = \"C:\\\\newlife\\\\newSite\\\\my-app\\\\component\\\\article\\\\comment.js\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React, { useEffect, useState } from \"react\";\nimport CommentList from \"./domList\";\n\nconst Comment = ({\n  message,\n  id\n}) => {\n  useEffect(() => {\n    //获取用户信息\n    let userId = localStorage.getItem(\"user-id\");\n    let userName = localStorage.getItem(\"user-name\");\n\n    if (!userId) {\n      userId = \"youke\" + Date.now();\n      localStorage.setItem(\"user-id\", userId);\n    }\n\n    if (!userName) {\n      userName = \"游客\" + String(Date.now()).slice(-5);\n      localStorage.setItem(\"user-name\", userName);\n    }\n\n    setUserName(userName);\n  }, []);\n  const {\n    0: userName,\n    1: setUserName\n  } = useState(null);\n\n  const changeUserName = e => {\n    //用户自定义名字\n    let value = e.target.value;\n    setUserName(value);\n    localStorage.setItem(\"user-name\", value);\n  };\n\n  const submitEvent = async e => {\n    //提交事件\n    try {\n      e.preventDefault();\n      let data = new FormData(e.target);\n      const QURL = process.env.DATA_URL + \"addArticle/articleComment/\" + id;\n      let res = await fetch(QURL, {\n        method: \"POST\",\n        body: data\n      });\n\n      if (res.ok) {\n        let result = await res.json();\n        setState(result);\n      } else {\n        alert(\"添加出错，服务器去看妹子了。\");\n        console.log(error);\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  const inputAutoHeight = e => {\n    let dom = e.target; // 内容高度自动适应\n\n    dom.style.height = dom.scrollHeight > dom.offsetHeight ? dom.scrollHeight + 10 + \"px\" : dom.offsetHeight + \"px\";\n  };\n\n  const {\n    0: state,\n    1: setState\n  } = useState(message.slice(0, 3)); //评论列表\n  //   let domList = state.map((item) => (\n  //     <div className=\"col-12\" key={item.createTime}>\n  //       <div className=\"row\">\n  //         <h3>{item.username + \" : \" + item.message}</h3>\n  //       </div>\n  //     </div>\n  //   ));\n\n  return __jsx(\"form\", {\n    onSubmit: submitEvent,\n    className: \"jsx-2726780744\" + \" \" + \"row comment m-0 p-0 justify-content-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 5\n    }\n  }, __jsx(\"div\", {\n    className: \"jsx-2726780744\" + \" \" + \"col-10 col-lg-8 \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }\n  }, __jsx(\"div\", {\n    className: \"jsx-2726780744\" + \" \" + \"row justify-content-between \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 9\n    }\n  }, __jsx(\"h2\", {\n    className: \"jsx-2726780744\" + \" \" + \"comment-item m-0 py-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 11\n    }\n  }, message.length, \" Comments\"), __jsx(\"input\", {\n    type: \"text\",\n    name: \"username\",\n    value: userName ? userName : \"\",\n    onInput: changeUserName,\n    onChange: changeUserName,\n    id: \"username\",\n    className: \"jsx-2726780744\" + \" \" + \"px-4 usename text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 11\n    }\n  })), __jsx(\"div\", {\n    className: \"jsx-2726780744\" + \" \" + \"row mt-5 align-items-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 9\n    }\n  }, __jsx(\"img\", {\n    src: \"images/site_05.jpg\",\n    alt: \"\",\n    className: \"jsx-2726780744\" + \" \" + \"col-auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 11\n    }\n  }), __jsx(\"textarea\", {\n    type: \"text\",\n    name: \"message\",\n    id: \"comment\",\n    onInput: inputAutoHeight,\n    className: \"jsx-2726780744\" + \" \" + \"col px-4 py-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 11\n    }\n  }), __jsx(\"button\", {\n    type: \"submit\",\n    className: \"jsx-2726780744\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 11\n    }\n  }, __jsx(\"i\", {\n    className: \"jsx-2726780744\" + \" \" + \"iconfont icon-cloud-upload col-auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 13\n    }\n  }))), __jsx(\"div\", {\n    style: {\n      padding: \"20px 80px\"\n    },\n    className: \"jsx-2726780744\" + \" \" + \"row comment-list justify-content-center align-items-center position-relative\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 9\n    }\n  }, message.length > 0 ? __jsx(CommentList, {\n    list: state,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 13\n    }\n  }) : __jsx(\"h3\", {\n    className: \"jsx-2726780744\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 13\n    }\n  }, \" Be the first to comment\\u3002 \"), __jsx(\"h4\", {\n    onClick: () => setState(message),\n    className: \"jsx-2726780744\" + \" \" + \"position-absolute look-more\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 11\n    }\n  }, \"look more\"))), __jsx(_JSXStyle, {\n    id: \"2726780744\",\n    __self: this\n  }, \".comment.jsx-2726780744{padding:10rem 0;}h2.jsx-2726780744{font-weight:700;}.look-more.jsx-2726780744{right:70px;top:10px;color:#007bff;cursor:pointer;}i.jsx-2726780744{font-size:40px;cursor:pointer;-webkit-transition:0.2s;transition:0.2s;}i.jsx-2726780744:hover{color:#007bff;}.col-8.jsx-2726780744>.row.jsx-2726780744:nth-child(1){border-bottom:2px solid #eaeaea;}img.jsx-2726780744{height:40px;border-radius:50%;}.comment-item.jsx-2726780744{border-bottom:2px solid black;position:relative;top:2px;}.comment-list.jsx-2726780744{min-height:20vh;border-bottom:2px solid #eaeaea;}input.jsx-2726780744,textarea.jsx-2726780744{font-size:2rem;font-weight:500;}input[name=\\\"username\\\"].jsx-2726780744{border:none;}button.jsx-2726780744{background:none;border:none;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxuZXdsaWZlXFxuZXdTaXRlXFxteS1hcHBcXGNvbXBvbmVudFxcYXJ0aWNsZVxcY29tbWVudC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFpSFMsQUFHNkIsQUFHQSxBQUdMLEFBTUksQUFLRCxBQUdrQixBQUdwQixBQUlrQixBQUtkLEFBS0QsQUFLSCxBQUdJLFdBdENQLENBaUJTLEFBbUJwQixFQXpCQSxDQUxpQixBQXlCQyxDQXJDbEIsQUFHQSxBQTZCa0MsQUFhcEIsSUF0Q0UsUUF1Q2hCLEVBakNrQixBQVdsQixBQUdvQixDQVdwQixDQWxCQSxFQVppQixjQW9CUCxBQUtWLENBeEJBLE9Bb0JBLGNBZkEiLCJmaWxlIjoiQzpcXG5ld2xpZmVcXG5ld1NpdGVcXG15LWFwcFxcY29tcG9uZW50XFxhcnRpY2xlXFxjb21tZW50LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IHVzZUVmZmVjdCwgdXNlU3RhdGUgfSBmcm9tIFwicmVhY3RcIjtcclxuaW1wb3J0IENvbW1lbnRMaXN0IGZyb20gXCIuL2RvbUxpc3RcIjtcclxuXHJcbmNvbnN0IENvbW1lbnQgPSAoeyBtZXNzYWdlLCBpZCB9KSA9PiB7XHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIC8v6I635Y+W55So5oi35L+h5oGvXHJcbiAgICBsZXQgdXNlcklkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJ1c2VyLWlkXCIpO1xyXG4gICAgbGV0IHVzZXJOYW1lID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJ1c2VyLW5hbWVcIik7XHJcbiAgICBpZiAoIXVzZXJJZCkge1xyXG4gICAgICB1c2VySWQgPSBcInlvdWtlXCIgKyBEYXRlLm5vdygpO1xyXG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInVzZXItaWRcIiwgdXNlcklkKTtcclxuICAgIH1cclxuICAgIGlmICghdXNlck5hbWUpIHtcclxuICAgICAgdXNlck5hbWUgPSBcIua4uOWuolwiICsgU3RyaW5nKERhdGUubm93KCkpLnNsaWNlKC01KTtcclxuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJ1c2VyLW5hbWVcIiwgdXNlck5hbWUpO1xyXG4gICAgfVxyXG4gICAgc2V0VXNlck5hbWUodXNlck5hbWUpO1xyXG4gIH0sIFtdKTtcclxuICBjb25zdCBbdXNlck5hbWUsIHNldFVzZXJOYW1lXSA9IHVzZVN0YXRlKG51bGwpO1xyXG4gIGNvbnN0IGNoYW5nZVVzZXJOYW1lID0gKGUpID0+IHtcclxuICAgIC8v55So5oi36Ieq5a6a5LmJ5ZCN5a2XXHJcbiAgICBsZXQgdmFsdWUgPSBlLnRhcmdldC52YWx1ZTtcclxuICAgIHNldFVzZXJOYW1lKHZhbHVlKTtcclxuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwidXNlci1uYW1lXCIsIHZhbHVlKTtcclxuICB9O1xyXG5cclxuICBjb25zdCBzdWJtaXRFdmVudCA9IGFzeW5jIChlKSA9PiB7XHJcbiAgICAvL+aPkOS6pOS6i+S7tlxyXG4gICAgdHJ5IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBsZXQgZGF0YSA9IG5ldyBGb3JtRGF0YShlLnRhcmdldCk7XHJcbiAgICAgIGNvbnN0IFFVUkwgPSBwcm9jZXNzLmVudi5EQVRBX1VSTCArIFwiYWRkQXJ0aWNsZS9hcnRpY2xlQ29tbWVudC9cIiArIGlkO1xyXG4gICAgICBsZXQgcmVzID0gYXdhaXQgZmV0Y2goUVVSTCwge1xyXG4gICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgYm9keTogZGF0YSxcclxuICAgICAgfSk7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgcmVzLmpzb24oKTtcclxuICAgICAgICBzZXRTdGF0ZShyZXN1bHQpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGFsZXJ0KFwi5re75Yqg5Ye66ZSZ77yM5pyN5Yqh5Zmo5Y6755yL5aa55a2Q5LqG44CCXCIpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICB9XHJcbiAgfTtcclxuICBjb25zdCBpbnB1dEF1dG9IZWlnaHQgPSAoZSkgPT4ge1xyXG4gICAgbGV0IGRvbSA9IGUudGFyZ2V0OyAvLyDlhoXlrrnpq5jluqboh6rliqjpgILlupRcclxuICAgIGRvbS5zdHlsZS5oZWlnaHQgPVxyXG4gICAgICBkb20uc2Nyb2xsSGVpZ2h0ID4gZG9tLm9mZnNldEhlaWdodFxyXG4gICAgICAgID8gZG9tLnNjcm9sbEhlaWdodCArIDEwICsgXCJweFwiXHJcbiAgICAgICAgOiBkb20ub2Zmc2V0SGVpZ2h0ICsgXCJweFwiO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IFtzdGF0ZSwgc2V0U3RhdGVdID0gdXNlU3RhdGUobWVzc2FnZS5zbGljZSgwLCAzKSk7IC8v6K+E6K665YiX6KGoXHJcblxyXG4gIC8vICAgbGV0IGRvbUxpc3QgPSBzdGF0ZS5tYXAoKGl0ZW0pID0+IChcclxuICAvLyAgICAgPGRpdiBjbGFzc05hbWU9XCJjb2wtMTJcIiBrZXk9e2l0ZW0uY3JlYXRlVGltZX0+XHJcbiAgLy8gICAgICAgPGRpdiBjbGFzc05hbWU9XCJyb3dcIj5cclxuICAvLyAgICAgICAgIDxoMz57aXRlbS51c2VybmFtZSArIFwiIDogXCIgKyBpdGVtLm1lc3NhZ2V9PC9oMz5cclxuICAvLyAgICAgICA8L2Rpdj5cclxuICAvLyAgICAgPC9kaXY+XHJcbiAgLy8gICApKTtcclxuICByZXR1cm4gKFxyXG4gICAgPGZvcm1cclxuICAgICAgY2xhc3NOYW1lPVwicm93IGNvbW1lbnQgbS0wIHAtMCBqdXN0aWZ5LWNvbnRlbnQtY2VudGVyXCJcclxuICAgICAgb25TdWJtaXQ9e3N1Ym1pdEV2ZW50fVxyXG4gICAgPlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbC0xMCBjb2wtbGctOCBcIj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInJvdyBqdXN0aWZ5LWNvbnRlbnQtYmV0d2VlbiBcIj5cclxuICAgICAgICAgIDxoMiBjbGFzc05hbWU9XCJjb21tZW50LWl0ZW0gbS0wIHB5LTNcIj57bWVzc2FnZS5sZW5ndGh9IENvbW1lbnRzPC9oMj5cclxuICAgICAgICAgIDxpbnB1dFxyXG4gICAgICAgICAgICB0eXBlPVwidGV4dFwiXHJcbiAgICAgICAgICAgIG5hbWU9XCJ1c2VybmFtZVwiXHJcbiAgICAgICAgICAgIHZhbHVlPXt1c2VyTmFtZSA/IHVzZXJOYW1lIDogXCJcIn1cclxuICAgICAgICAgICAgb25JbnB1dD17Y2hhbmdlVXNlck5hbWV9XHJcbiAgICAgICAgICAgIG9uQ2hhbmdlPXtjaGFuZ2VVc2VyTmFtZX1cclxuICAgICAgICAgICAgaWQ9XCJ1c2VybmFtZVwiXHJcbiAgICAgICAgICAgIGNsYXNzTmFtZT1cInB4LTQgdXNlbmFtZSB0ZXh0LWNlbnRlclwiXHJcbiAgICAgICAgICAvPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicm93IG10LTUgYWxpZ24taXRlbXMtY2VudGVyXCI+XHJcbiAgICAgICAgICA8aW1nIHNyYz1cImltYWdlcy9zaXRlXzA1LmpwZ1wiIGNsYXNzTmFtZT1cImNvbC1hdXRvXCIgYWx0PVwiXCIgLz5cclxuICAgICAgICAgIDx0ZXh0YXJlYVxyXG4gICAgICAgICAgICB0eXBlPVwidGV4dFwiXHJcbiAgICAgICAgICAgIG5hbWU9XCJtZXNzYWdlXCJcclxuICAgICAgICAgICAgaWQ9XCJjb21tZW50XCJcclxuICAgICAgICAgICAgY2xhc3NOYW1lPVwiY29sIHB4LTQgcHktMlwiXHJcbiAgICAgICAgICAgIG9uSW5wdXQ9e2lucHV0QXV0b0hlaWdodH1cclxuICAgICAgICAgIC8+XHJcbiAgICAgICAgICA8YnV0dG9uIHR5cGU9XCJzdWJtaXRcIj5cclxuICAgICAgICAgICAgPGkgY2xhc3NOYW1lPVwiaWNvbmZvbnQgaWNvbi1jbG91ZC11cGxvYWQgY29sLWF1dG9cIj48L2k+XHJcbiAgICAgICAgICA8L2J1dHRvbj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8ZGl2XHJcbiAgICAgICAgICBjbGFzc05hbWU9XCJyb3cgY29tbWVudC1saXN0IGp1c3RpZnktY29udGVudC1jZW50ZXIgYWxpZ24taXRlbXMtY2VudGVyIHBvc2l0aW9uLXJlbGF0aXZlXCJcclxuICAgICAgICAgIHN0eWxlPXt7IHBhZGRpbmc6IFwiMjBweCA4MHB4XCIgfX1cclxuICAgICAgICA+XHJcbiAgICAgICAgICB7bWVzc2FnZS5sZW5ndGggPiAwID8gKFxyXG4gICAgICAgICAgICA8Q29tbWVudExpc3QgbGlzdD17c3RhdGV9IC8+XHJcbiAgICAgICAgICApIDogKFxyXG4gICAgICAgICAgICA8aDM+IEJlIHRoZSBmaXJzdCB0byBjb21tZW5044CCIDwvaDM+XHJcbiAgICAgICAgICApfVxyXG4gICAgICAgICAgPGg0XHJcbiAgICAgICAgICAgIGNsYXNzTmFtZT1cInBvc2l0aW9uLWFic29sdXRlIGxvb2stbW9yZVwiXHJcbiAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHNldFN0YXRlKG1lc3NhZ2UpfVxyXG4gICAgICAgICAgPlxyXG4gICAgICAgICAgICBsb29rIG1vcmVcclxuICAgICAgICAgIDwvaDQ+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgICA8c3R5bGUganN4PlxyXG4gICAgICAgIHtgXHJcbiAgICAgICAgICAuY29tbWVudCB7XHJcbiAgICAgICAgICAgIHBhZGRpbmc6IDEwcmVtIDA7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBoMiB7XHJcbiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA3MDA7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICAubG9vay1tb3JlIHtcclxuICAgICAgICAgICAgcmlnaHQ6IDcwcHg7XHJcbiAgICAgICAgICAgIHRvcDogMTBweDtcclxuICAgICAgICAgICAgY29sb3I6ICMwMDdiZmY7XHJcbiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGkge1xyXG4gICAgICAgICAgICBmb250LXNpemU6IDQwcHg7XHJcbiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjtcclxuICAgICAgICAgICAgdHJhbnNpdGlvbjogMC4ycztcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGk6aG92ZXIge1xyXG4gICAgICAgICAgICBjb2xvcjogIzAwN2JmZjtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIC5jb2wtOCA+IC5yb3c6bnRoLWNoaWxkKDEpIHtcclxuICAgICAgICAgICAgYm9yZGVyLWJvdHRvbTogMnB4IHNvbGlkICNlYWVhZWE7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBpbWcge1xyXG4gICAgICAgICAgICBoZWlnaHQ6IDQwcHg7XHJcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIC5jb21tZW50LWl0ZW0ge1xyXG4gICAgICAgICAgICBib3JkZXItYm90dG9tOiAycHggc29saWQgYmxhY2s7XHJcbiAgICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcclxuICAgICAgICAgICAgdG9wOiAycHg7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICAuY29tbWVudC1saXN0IHtcclxuICAgICAgICAgICAgbWluLWhlaWdodDogMjB2aDtcclxuICAgICAgICAgICAgYm9yZGVyLWJvdHRvbTogMnB4IHNvbGlkICNlYWVhZWE7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBpbnB1dCxcclxuICAgICAgICAgIHRleHRhcmVhIHtcclxuICAgICAgICAgICAgZm9udC1zaXplOiAycmVtO1xyXG4gICAgICAgICAgICBmb250LXdlaWdodDogNTAwO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIGlucHV0W25hbWU9XCJ1c2VybmFtZVwiXSB7XHJcbiAgICAgICAgICAgIGJvcmRlcjogbm9uZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGJ1dHRvbiB7XHJcbiAgICAgICAgICAgIGJhY2tncm91bmQ6IG5vbmU7XHJcbiAgICAgICAgICAgIGJvcmRlcjogbm9uZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICBgfVxyXG4gICAgICA8L3N0eWxlPlxyXG4gICAgPC9mb3JtPlxyXG4gICk7XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBDb21tZW50O1xyXG4iXX0= */\\n/*@ sourceURL=C:\\\\\\\\newlife\\\\\\\\newSite\\\\\\\\my-app\\\\\\\\component\\\\\\\\article\\\\\\\\comment.js */\"));\n};\n\nexport default Comment;","map":{"version":3,"sources":["C:/newlife/newSite/my-app/component/article/comment.js"],"names":["React","useEffect","useState","CommentList","Comment","message","id","userId","localStorage","getItem","userName","Date","now","setItem","String","slice","setUserName","changeUserName","e","value","target","submitEvent","preventDefault","data","FormData","QURL","process","env","DATA_URL","res","fetch","method","body","ok","result","json","setState","alert","console","log","error","err","inputAutoHeight","dom","style","height","scrollHeight","offsetHeight","state","length","padding"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport CommentList from \"./domList\";\r\n\r\nconst Comment = ({ message, id }) => {\r\n  useEffect(() => {\r\n    //获取用户信息\r\n    let userId = localStorage.getItem(\"user-id\");\r\n    let userName = localStorage.getItem(\"user-name\");\r\n    if (!userId) {\r\n      userId = \"youke\" + Date.now();\r\n      localStorage.setItem(\"user-id\", userId);\r\n    }\r\n    if (!userName) {\r\n      userName = \"游客\" + String(Date.now()).slice(-5);\r\n      localStorage.setItem(\"user-name\", userName);\r\n    }\r\n    setUserName(userName);\r\n  }, []);\r\n  const [userName, setUserName] = useState(null);\r\n  const changeUserName = (e) => {\r\n    //用户自定义名字\r\n    let value = e.target.value;\r\n    setUserName(value);\r\n    localStorage.setItem(\"user-name\", value);\r\n  };\r\n\r\n  const submitEvent = async (e) => {\r\n    //提交事件\r\n    try {\r\n      e.preventDefault();\r\n      let data = new FormData(e.target);\r\n      const QURL = process.env.DATA_URL + \"addArticle/articleComment/\" + id;\r\n      let res = await fetch(QURL, {\r\n        method: \"POST\",\r\n        body: data,\r\n      });\r\n      if (res.ok) {\r\n        let result = await res.json();\r\n        setState(result);\r\n      } else {\r\n        alert(\"添加出错，服务器去看妹子了。\");\r\n        console.log(error);\r\n      }\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n  const inputAutoHeight = (e) => {\r\n    let dom = e.target; // 内容高度自动适应\r\n    dom.style.height =\r\n      dom.scrollHeight > dom.offsetHeight\r\n        ? dom.scrollHeight + 10 + \"px\"\r\n        : dom.offsetHeight + \"px\";\r\n  };\r\n\r\n  const [state, setState] = useState(message.slice(0, 3)); //评论列表\r\n\r\n  //   let domList = state.map((item) => (\r\n  //     <div className=\"col-12\" key={item.createTime}>\r\n  //       <div className=\"row\">\r\n  //         <h3>{item.username + \" : \" + item.message}</h3>\r\n  //       </div>\r\n  //     </div>\r\n  //   ));\r\n  return (\r\n    <form\r\n      className=\"row comment m-0 p-0 justify-content-center\"\r\n      onSubmit={submitEvent}\r\n    >\r\n      <div className=\"col-10 col-lg-8 \">\r\n        <div className=\"row justify-content-between \">\r\n          <h2 className=\"comment-item m-0 py-3\">{message.length} Comments</h2>\r\n          <input\r\n            type=\"text\"\r\n            name=\"username\"\r\n            value={userName ? userName : \"\"}\r\n            onInput={changeUserName}\r\n            onChange={changeUserName}\r\n            id=\"username\"\r\n            className=\"px-4 usename text-center\"\r\n          />\r\n        </div>\r\n        <div className=\"row mt-5 align-items-center\">\r\n          <img src=\"images/site_05.jpg\" className=\"col-auto\" alt=\"\" />\r\n          <textarea\r\n            type=\"text\"\r\n            name=\"message\"\r\n            id=\"comment\"\r\n            className=\"col px-4 py-2\"\r\n            onInput={inputAutoHeight}\r\n          />\r\n          <button type=\"submit\">\r\n            <i className=\"iconfont icon-cloud-upload col-auto\"></i>\r\n          </button>\r\n        </div>\r\n        <div\r\n          className=\"row comment-list justify-content-center align-items-center position-relative\"\r\n          style={{ padding: \"20px 80px\" }}\r\n        >\r\n          {message.length > 0 ? (\r\n            <CommentList list={state} />\r\n          ) : (\r\n            <h3> Be the first to comment。 </h3>\r\n          )}\r\n          <h4\r\n            className=\"position-absolute look-more\"\r\n            onClick={() => setState(message)}\r\n          >\r\n            look more\r\n          </h4>\r\n        </div>\r\n      </div>\r\n      <style jsx>\r\n        {`\r\n          .comment {\r\n            padding: 10rem 0;\r\n          }\r\n          h2 {\r\n            font-weight: 700;\r\n          }\r\n          .look-more {\r\n            right: 70px;\r\n            top: 10px;\r\n            color: #007bff;\r\n            cursor: pointer;\r\n          }\r\n          i {\r\n            font-size: 40px;\r\n            cursor: pointer;\r\n            transition: 0.2s;\r\n          }\r\n          i:hover {\r\n            color: #007bff;\r\n          }\r\n          .col-8 > .row:nth-child(1) {\r\n            border-bottom: 2px solid #eaeaea;\r\n          }\r\n          img {\r\n            height: 40px;\r\n            border-radius: 50%;\r\n          }\r\n          .comment-item {\r\n            border-bottom: 2px solid black;\r\n            position: relative;\r\n            top: 2px;\r\n          }\r\n          .comment-list {\r\n            min-height: 20vh;\r\n            border-bottom: 2px solid #eaeaea;\r\n          }\r\n          input,\r\n          textarea {\r\n            font-size: 2rem;\r\n            font-weight: 500;\r\n          }\r\n\r\n          input[name=\"username\"] {\r\n            border: none;\r\n          }\r\n          button {\r\n            background: none;\r\n            border: none;\r\n          }\r\n        `}\r\n      </style>\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default Comment;\r\n"]},"metadata":{},"sourceType":"module"}